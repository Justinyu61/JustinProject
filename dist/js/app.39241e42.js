(function(){"use strict";var t={5903:function(t,e,o){var s=o(9242),a=o(6265),n=o.n(a),l=o(6423),r=o(3396);function i(t,e){const o=(0,r.up)("router-view");return(0,r.wg)(),(0,r.j4)(o)}var c=o(89);const d={},u=(0,c.Z)(d,[["render",i]]);var p=u,m=o(2483);const h={class:"container mt-5"},b={class:"col-md-6"},v=(0,r._)("h1",{class:"h3 mb-3 font-weight-normal"},"請先登入",-1),g={class:"mb-2"},f=(0,r._)("label",{for:"inputEmail",class:"sr-only"},"Email address",-1),_={class:"mb-2"},w=(0,r._)("label",{for:"inputPassword",class:"sr-only"},"Password",-1),y=(0,r._)("div",{class:"text-end mt-4"},[(0,r._)("button",{class:"btn btn-lg btn-primary btn-block",type:"submit"},"登入")],-1);function x(t,e,o,a,n,l){return(0,r.wg)(),(0,r.iD)("div",h,[(0,r._)("form",{class:"row justify-content-center",onSubmit:e[2]||(e[2]=(0,s.iM)(((...t)=>a.signIn&&a.signIn(...t)),["prevent"]))},[(0,r._)("div",b,[v,(0,r._)("div",g,[f,(0,r.wy)((0,r._)("input",{type:"email",id:"inputEmail",class:"form-control",placeholder:"Email address",required:"",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=t=>a.username=t)},null,512),[[s.nr,a.username]])]),(0,r._)("div",_,[w,(0,r.wy)((0,r._)("input",{type:"password",id:"inputPassword",class:"form-control",placeholder:"Password",required:"","onUpdate:modelValue":e[1]||(e[1]=t=>a.password=t)},null,512),[[s.nr,a.password]])]),y])],32)])}var P=o(4870);const k=n().create({baseURL:"https://vue3-course-api.hexschool.io/",timeout:1e4}),M=(t,e={})=>new Promise(((o,s)=>{k.post(t,e).then((t=>{o(t)}),(t=>{s(t)}))})),$=()=>{const t=(0,m.tv)(),e=(0,P.qj)({username:"",password:""}),o=async()=>{try{const o=await M("admin/signin",{username:e.username,password:e.password});if(o?.data?.success){const{token:e,expired:s}=o.data;document.cookie=`hexToken=${e}; expires=${new Date(s)}`,console.log("登入成功"),await t.push("/dashboard/products")}}catch(o){console.log(o)}},{username:s,password:a}=(0,P.BK)(e);return{username:s,password:a,signIn:o}};var j={name:"Login-view",setup(){const{username:t,password:e,signIn:o}=$();return{username:t,password:e,signIn:o}}};const D=(0,c.Z)(j,[["render",x]]);var U=D;const L={class:"container-fluid mt-3 position-relative"};function C(t,e,o,s,a,n){const l=(0,r.up)("Navbar"),i=(0,r.up)("ToastMessages"),c=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(l),(0,r._)("div",L,[(0,r.Wm)(i),(0,r.Wm)(c)])],64)}const O={class:"navbar navbar-expand-lg navbar-light bg-light"},Z=(0,r._)("a",{class:"navbar-brand",href:"#"},"Navbar",-1),T=(0,r._)("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,r._)("span",{class:"navbar-toggler-icon"})],-1),E={class:"collapse navbar-collapse",id:"navbarNav"},N={class:"navbar-nav"},V=(0,r.uE)('<li class="nav-item"><a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a></li><li class="nav-item"><a class="nav-link" href="#">Features</a></li><li class="nav-item"><a class="nav-link" href="#">Pricing</a></li>',3),z={class:"nav-item"};function I(t,e,o,a,n,l){return(0,r.wg)(),(0,r.iD)("nav",O,[Z,T,(0,r._)("div",E,[(0,r._)("ul",N,[V,(0,r._)("li",z,[(0,r._)("a",{class:"nav-link",href:"#",onClick:e[0]||(e[0]=(0,s.iM)(((...t)=>l.logout&&l.logout(...t)),["prevent"]))},"Logout")])])])])}var F={name:"Navbar-view",methods:{logout(){const t="https://vue3-course-api.hexschool.io/logout";this.$http.post(t,this.user).then((t=>{t.data.success&&this.$router.push("/login")}))}}};const W=(0,c.Z)(F,[["render",I]]);var H=W,q=o(1373);const Y=(0,q.Z)();var K=Y;const S={class:"toast container position-absolute pe-3 top-0 end-0"};function A(t,e,o,s,a,n){const l=(0,r.up)("Toast");return(0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.messages,((t,e)=>((0,r.wg)(),(0,r.j4)(l,{key:e,msg:t},null,8,["msg"])))),128))])}var B=o(7139);const R={class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast"},G={class:"toast-header"},J={class:"me-auto"},Q=(0,r._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"},null,-1),X={key:0,class:"toast-body"};function tt(t,e,o,s,a,n){return(0,r.wg)(),(0,r.iD)("div",R,[(0,r._)("div",G,[(0,r._)("span",{class:(0,B.C_)([`bg-${o.msg.title}`,"p-2 rounded me-2 d-inline-block"])},null,2),(0,r._)("strong",J,(0,B.zw)(o.msg.title),1),Q]),o.msg.content?((0,r.wg)(),(0,r.iD)("div",X,(0,B.zw)(o.msg.content),1)):(0,r.kq)("",!0)],512)}var et=o(8803),ot=o.n(et),st={name:"Toast-view",props:["msg"],mounted(){const t=this.$refs.toast,e=new(ot())(t,{delay:6e3});e.show()}};const at=(0,c.Z)(st,[["render",tt]]);var nt=at,lt={name:"ToastMessages",components:{Toast:nt},data(){return{messages:[]}},inject:["emitter"],mounted(){this.emitter.on("push-message",(t=>{const{style:e="success",title:o,content:s}=t;this.messages.push({style:e,title:o,content:s})}))}};const rt=(0,c.Z)(lt,[["render",A]]);var it=rt,ct={name:"Dashboard-view",components:{Navbar:H,ToastMessages:it},created(){this.$http.defaults.headers.common.Authorization=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");const t="https://vue3-course-api.hexschool.io/api/user/check";this.$http.post(t,this.user).then((t=>{t.data.success||this.$router.push("/login")}))},provide(){return{emitter:K}}};const dt=(0,c.Z)(ct,[["render",C]]);var ut=dt;const pt={class:"text-end"},mt={class:"table mt-4"},ht=(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",{width:"120"},"分類"),(0,r._)("th",null,"產品名稱"),(0,r._)("th",{width:"120"},"原價"),(0,r._)("th",{width:"120"},"售價"),(0,r._)("th",{width:"100"},"是否啟用"),(0,r._)("th",{width:"200"},"編輯")])],-1),bt={class:"text-right"},vt={class:"text-right"},gt={key:0,class:"text-success"},ft={key:1,class:"text-muted"},_t={class:"btn-group"},wt=["onClick"],yt=["onClick"];function xt(t,e,o,s,a,n){const l=(0,r.up)("Loading"),i=(0,r.up)("ProductModal"),c=(0,r.up)("DeleteModal");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(l,{active:a.isLoading},null,8,["active"]),(0,r._)("div",pt,[(0,r._)("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=t=>n.openModal(!0))}," 新增產品 ")]),(0,r._)("table",mt,[ht,(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.products,(t=>((0,r.wg)(),(0,r.iD)("tr",{key:t.id},[(0,r._)("td",null,(0,B.zw)(t.category),1),(0,r._)("td",null,(0,B.zw)(t.title),1),(0,r._)("td",bt,(0,B.zw)(t.origin_price),1),(0,r._)("td",vt,(0,B.zw)(t.price),1),(0,r._)("td",null,[t.is_enabled?((0,r.wg)(),(0,r.iD)("span",gt,"啟用")):((0,r.wg)(),(0,r.iD)("span",ft,"未啟用"))]),(0,r._)("td",null,[(0,r._)("div",_t,[(0,r._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>n.openModal(!1,t)},"編輯",8,wt),(0,r._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>n.deleteProductModal(t)},"刪除",8,yt)])])])))),128))])]),(0,r.Wm)(i,{ref:"productModal",product:a.tempProduct,onUpdateProduct:n.updateProduct},null,8,["product","onUpdateProduct"]),(0,r.Wm)(c,{ref:"deleteModal",item:a.tempProduct,onDeleteItem:n.deleteProduct},null,8,["item","onDeleteItem"])],64)}const Pt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},kt={class:"modal-dialog modal-xl",role:"document"},Mt={class:"modal-content border-0"},$t=(0,r._)("div",{class:"modal-header bg-dark text-white"},[(0,r._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,r._)("span",null,"新增產品")]),(0,r._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),jt={class:"modal-body"},Dt={class:"row"},Ut={class:"col-sm-4"},Lt={class:"mb-3"},Ct=(0,r._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),Ot={class:"mb-3"},Zt=(0,r._)("label",{for:"customFile",class:"form-label"},[(0,r.Uk)("或 上傳圖片 "),(0,r._)("i",{class:"fas fa-spinner fa-spin"})],-1),Tt=(0,r.uE)('<img class="img-fluid" alt=""><div class="mt-5"><div class="mb-3 input-group"><input type="url" class="form-control form-control" placeholder="請輸入連結"><button type="button" class="btn btn-outline-danger"> 移除 </button></div><div><button class="btn btn-outline-primary btn-sm d-block w-100"> 新增圖片 </button></div></div>',2),Et={class:"col-sm-8"},Nt={class:"mb-3"},Vt=(0,r._)("label",{for:"title",class:"form-label"},"標題",-1),zt={class:"row gx-2"},It={class:"mb-3 col-md-6"},Ft=(0,r._)("label",{for:"category",class:"form-label"},"分類",-1),Wt={class:"mb-3 col-md-6"},Ht=(0,r._)("label",{for:"price",class:"form-label"},"單位",-1),qt={class:"row gx-2"},Yt={class:"mb-3 col-md-6"},Kt=(0,r._)("label",{for:"origin_price",class:"form-label"},"原價",-1),St={class:"mb-3 col-md-6"},At=(0,r._)("label",{for:"price",class:"form-label"},"售價",-1),Bt=(0,r._)("hr",null,null,-1),Rt={class:"mb-3"},Gt=(0,r._)("label",{for:"description",class:"form-label"},"產品描述",-1),Jt={class:"mb-3"},Qt=(0,r._)("label",{for:"content",class:"form-label"},"說明內容",-1),Xt=(0,r._)("div",{class:"mb-3"},[(0,r._)("div",{class:"form-check"},[(0,r._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled"}),(0,r._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ")])],-1),te={class:"modal-footer"},ee=(0,r._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function oe(t,e,o,a,n,l){return(0,r.wg)(),(0,r.iD)("div",Pt,[(0,r._)("div",kt,[(0,r._)("div",Mt,[$t,(0,r._)("div",jt,[(0,r._)("div",Dt,[(0,r._)("div",Ut,[(0,r._)("div",Lt,[Ct,(0,r.wy)((0,r._)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>n.tempProduct.imageUrl=t)},null,512),[[s.nr,n.tempProduct.imageUrl]])]),(0,r._)("div",Ot,[Zt,(0,r._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>l.uploadFile&&l.uploadFile(...t))},null,544)]),Tt]),(0,r._)("div",Et,[(0,r._)("div",Nt,[Vt,(0,r.wy)((0,r._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=t=>n.tempProduct.title=t)},null,512),[[s.nr,n.tempProduct.title]])]),(0,r._)("div",zt,[(0,r._)("div",It,[Ft,(0,r.wy)((0,r._)("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":e[3]||(e[3]=t=>n.tempProduct.category=t)},null,512),[[s.nr,n.tempProduct.category]])]),(0,r._)("div",Wt,[Ht,(0,r.wy)((0,r._)("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":e[4]||(e[4]=t=>n.tempProduct.unit=t)},null,512),[[s.nr,n.tempProduct.unit]])])]),(0,r._)("div",qt,[(0,r._)("div",Yt,[Kt,(0,r.wy)((0,r._)("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":e[5]||(e[5]=t=>n.tempProduct.origin_price=t)},null,512),[[s.nr,n.tempProduct.origin_price]])]),(0,r._)("div",St,[At,(0,r.wy)((0,r._)("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":e[6]||(e[6]=t=>n.tempProduct.price=t)},null,512),[[s.nr,n.tempProduct.price]])])]),Bt,(0,r._)("div",Rt,[Gt,(0,r.wy)((0,r._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":e[7]||(e[7]=t=>n.tempProduct.description=t)},null,512),[[s.nr,n.tempProduct.description]])]),(0,r._)("div",Jt,[Qt,(0,r.wy)((0,r._)("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[8]||(e[8]=t=>n.tempProduct.content=t)},null,512),[[s.nr,n.tempProduct.content]])]),Xt])])]),(0,r._)("div",te,[ee,(0,r._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("update-product",n.tempProduct))},"確認")])])])],512)}var se=o(7972),ae=o.n(se),ne={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(ae())(this.$refs.modal)}},le={name:"ProductModal",props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=this.product}},data(){return{modal:{},tempProduct:{}}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const o="https://vue3-course-api.hexschool.io/api/justinyu61-api/admin/upload";console.log(o),this.$http.post(o,e).then((t=>{console.log(t.data),t.data.success&&(this.tempProduct.imageUrl=t.data.imageUrl)}))}},mixins:[ne]};const re=(0,c.Z)(le,[["render",oe]]);var ie=re;const ce={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},de={class:"modal-dialog",role:"document"},ue={class:"modal-content border-0"},pe={class:"modal-header bg-danger text-white"},me={class:"modal-title"},he=(0,r._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),be={class:"modal-body"},ve=(0,r.Uk)(" 是否刪除 "),ge={class:"text-danger"},fe=(0,r.Uk)(" (刪除後將無法恢復)。 "),_e={class:"modal-footer"},we=(0,r._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function ye(t,e,o,s,a,n){return(0,r.wg)(),(0,r.iD)("div",ce,[(0,r._)("div",de,[(0,r._)("div",ue,[(0,r._)("div",pe,[(0,r._)("h5",me,[(0,r._)("span",null,"刪除 "+(0,B.zw)(o.item.title),1)]),he]),(0,r._)("div",be,[ve,(0,r._)("strong",ge,(0,B.zw)(o.item.title),1),fe]),(0,r._)("div",_e,[we,(0,r._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("delete-item"))},"確認刪除 ")])])])],512)}var xe={name:"DeleteModal",props:{item:{}},data(){return{modal:""}},mixins:[ne]};const Pe=(0,c.Z)(xe,[["render",ye]]);var ke=Pe,Me={name:"Products-view",data(){return{products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1}},inject:["emitter"],components:{ProductModal:ie,DeleteModal:ke},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/justinyu61-api/admin/products?page=:page";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}))},openModal(t,e){this.tempProduct=t?{}:{...e},this.isNew=t;const o=this.$refs.productModal;o.showModal(),this.isLoading=!1},updateProduct(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/justinyu61-api/admin/product",o="post";this.isLoading=!0,this.isNew||(e=`https://vue3-course-api.hexschool.io/api/justinyu61-api/admin/product/${t.id}`,o="put",this.isLoading=!0);const s=this.$refs.productModal;this.$http[o](e,{data:this.tempProduct}).then((t=>{s.hideModal(),t.data.success?(this.getProducts(),this.emitter.emit("push-message",{style:"success",title:"更新成功"})):this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:t.data.message.join("、")})})),this.isLoading=!1},deleteProductModal(t){this.tempProduct={...t};const e=this.$refs.deleteModal;e.showModal()},deleteProduct(){const t=`https://vue3-course-api.hexschool.io/api/justinyu61-api/admin/product/${this.tempProduct.id}`;this.$http.delete(t).then((t=>{console.log(t.data);const e=this.$refs.deleteModal;e.hideModal(),this.getProducts()}))}},created(){this.getProducts()}};const $e=(0,c.Z)(Me,[["render",xt]]);var je=$e;const De=[{path:"/login",name:"Login",component:U},{path:"/dashboard",component:ut,children:[{path:"products",component:je}]}],Ue=(0,m.p7)({history:(0,m.r5)(),routes:De,linkActiveClass:"active"});var Le=Ue,Ce=o(6216);(0,s.ri)(p).component("Loading",Ce.Z).use(l.Z,n()).use(Le).mount("#app")}},e={};function o(s){var a=e[s];if(void 0!==a)return a.exports;var n=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=t,function(){o.amdO={}}(),function(){var t=[];o.O=function(e,s,a,n){if(!s){var l=1/0;for(d=0;d<t.length;d++){s=t[d][0],a=t[d][1],n=t[d][2];for(var r=!0,i=0;i<s.length;i++)(!1&n||l>=n)&&Object.keys(o.O).every((function(t){return o.O[t](s[i])}))?s.splice(i--,1):(r=!1,n<l&&(l=n));if(r){t.splice(d--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[s,a,n]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,n,l=s[0],r=s[1],i=s[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(i)var d=i(o)}for(e&&e(s);c<l.length;c++)n=l[c],o.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return o.O(d)},s=self["webpackChunkjustin_project"]=self["webpackChunkjustin_project"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(5903)}));s=o.O(s)})();
//# sourceMappingURL=app.39241e42.js.map